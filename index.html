<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notre Rituel ‚ù§Ô∏è</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
        body { font-family: 'Poppins', sans-serif; background: #fff0f3; color: #444; text-align: center; padding: 20px; margin: 0; }
        .card { background: white; max-width: 500px; margin: 20px auto; padding: 30px; border-radius: 30px; box-shadow: 0 10px 30px rgba(255,182,193,0.3); }
        h1 { color: #ff4d6d; font-size: 1.6rem; margin: 0; }
        #current-date { display: block; margin-bottom: 20px; font-size: 0.85rem; color: #888; }
        .question-block { background: #fff5f6; margin: 15px 0; padding: 20px; border-radius: 20px; border-left: 6px solid #ff4d6d; text-align: left; }
        .locked { opacity: 0.5; border-left-color: #ccc; background: #f9f9f9; }
        textarea { width: 100%; border: 1px solid #ddd; border-radius: 12px; padding: 12px; box-sizing: border-box; margin-top: 10px; resize: none; font-family: inherit; }
        input#mon-prenom { width: 100%; max-width: 300px; padding: 12px; border-radius: 15px; border: 1px solid #ddd; margin: 20px 0; text-align: center; }
        button { background: #ff4d6d; color: white; border: none; padding: 15px 40px; border-radius: 50px; cursor: pointer; font-weight: 600; width: 100%; max-width: 300px; }
        .res { font-size: 0.9rem; margin-bottom: 20px; text-align: left; background: #fff; padding: 15px; border-radius: 20px; border: 1px solid #ffe5ec; }
        .res strong { color: #ff4d6d; }
        .heart { position: fixed; font-size: 20px; z-index: 999; pointer-events: none; animation: fall linear forwards; }
        @keyframes fall { to { transform: translateY(100vh) rotate(360deg); opacity: 0; } }
        hr { border: 0; border-top: 1px dashed #ffd1d1; margin: 30px 0; }
    </style>
</head>
<body>

<div class="card">
    <h1>‚ú® Notre Rituel</h1>
    <span id="current-date"></span>
    <div id="questions-list">Chargement des questions...</div>
    <input type="text" id="mon-prenom" placeholder="Ton petit nom...">
    <button onclick="envoyer()">Envoyer nos r√©ponses ‚ù§Ô∏è</button>
    <hr>
    <h3 style="color: #ff4d6d;">Nos souvenirs r√©cents</h3>
    <div id="reponses-flux">En attente de mots doux...</div>
</div>

<script>
    // 1. CONFIGURATION
    const firebaseConfig = {
        databaseURL: "https://notre-petit-coin-default-rtdb.europe-west1.firebasedatabase.app"
    };

    // Initialisation s√©curis√©e
    let database;
    try {
        firebase.initializeApp(firebaseConfig);
        database = firebase.database();
    } catch (e) {
        console.error("Firebase init error", e);
    }

    // 2. QUESTIONS
    const qMatin = [
        "C'est quoi la connerie qu'on a faite ensemble qui te fait marrer ?", "Si tu ne devais garder qu‚Äôun souvenir de moi ce serait lequel ?",
        "Quelle est ma manie la plus bizarre que tu as d√©couverte ?", "Budget illimit√© : qu‚Äôest-ce que tu m‚Äôach√®terais ?",
        "Si je devais devenir une star, je serais c√©l√®bre pour quoi ?", "Quel est le plus beau compliment que je t‚Äôai fait ?",
        "Si je t‚Äôenvoie un message 'j‚Äôai merd√©', tu penses que ce serait sur quoi ?", "Si on √©tait des animaux, on serait quoi ?",
        "Quelle est la photo de nous deux que tu aimerais faire ?", "Quelle est la chose la plus courageuse que tu as faite cette ann√©e ?",
        "Pour toi, quelle est ma passion ?", "Si je finis en prison, ce serait pour quel motif ?",
        "Si on √©changeait nos corps pendant 24h, c'est quoi la premi√®re chose que tu ferais ?", "C‚Äôest quoi ton moment pr√©f√©r√© la derni√®re fois qu‚Äôon s‚Äôest vu ?",
        "Donne 3 mots pour d√©crire notre relation.", "Si tu devais te vanter de moi devant un inconnu, tu dirais quoi ?",
        "Si tu pouvais changer une seule chose dans ton quotidien, ce serait quoi ?", "Quelle est la petite chose que je fais et qui te fait craquer ?",
        "Si on devait partir en voyage, tu partirais o√π ?", "Une chose que je fais mieux que tout le monde ?",
        "Quel est mon plus gros d√©faut ?", "Si tu devais dispara√Ætre un temps, ce serait o√π ?",
        "Quelle est la recherche la plus √©trange sur Google r√©cemment ?", "Quel est le rituel √† distance que tu pr√©f√®res ?",
        "Je ressemble √† quoi comme cr√©ature moche ?", "Qu‚Äôest-ce qui te manque le plus le soir ?"
    ];

    const qSoir = [
        "Quel souvenir intime avec moi t‚Äôa le plus marqu√© ?", "Si on vivait nus dans une for√™t, qui craquerait en premier ?",
        "Quel est l'endroit le plus insolite o√π tu aimerais qu'on le fasse ?", "Comment imagines-tu notre vie dans 10 ans ?",
        "Qu'est-ce qui te fait dire que 'c'est moi et personne d'autre' ?", "Quelle partie de mon corps te fait le plus d'effet ?",
        "Si tu avais une option 't√©l√©command√©e' sur moi, quel bouton ?", "Quelle est la blessure du pass√© que j'ai apais√©e ?",
        "Le truc le plus bizarre qui t'excite ?", "Ton souvenir le plus doux sous la couette ?",
        "Quelle est la pire chose que tu aies faite par jalousie ?", "Si on effa√ßait un moment du pass√© ?",
        "Quel est ton pire 'tue-l'amour' chez moi ?", "C'est quoi ta plus grande peur pour notre futur ?",
        "Si tu devais me confier une mission bonheur ?", "Le moment o√π je t‚Äôai fait le plus rire ?",
        "Ta zone la plus sensible pas assez explor√©e ?", "Si je devais te surprendre ce soir ?",
        "Quel est ton plus beau souvenir avec moi ?", "De quoi as-tu besoin pour te sentir en s√©curit√© ?",
        "Ton r√™ve jamais dit √† personne ?", "Ta partie pr√©f√©r√©e de mon corps (pas les yeux) ?",
        "Si on faisait une t√©l√©-r√©alit√© ?", "Ton secret le plus bizarre ?",
        "Qu'est-ce que notre relation t'a appris ?", "Un 'bon pour tout' d'une heure ?",
        "Ta plus grande peur en amour ?", "Si c'√©tait √† refaire ?"
    ];

    // 3. AFFICHAGE
    const maintenant = new Date();
    const heure = maintenant.getHours();
    const jour = maintenant.getDate();
    document.getElementById('current-date').innerText = maintenant.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' });

    const qList = document.getElementById('questions-list');
    const question1 = qMatin[jour % qMatin.length];
    const question2 = qSoir[jour % qSoir.length];

    let htmlContenu = `<div class="question-block">‚òÄÔ∏è <strong>${question1}</strong><textarea id="rep1" rows="2"></textarea></div>`;

    if (heure >= 19 || heure < 6) {
        htmlContenu += `<div class="question-block" style="border-left-color:#7209b7">üåô <strong>${question2}</strong><textarea id="rep2" rows="2"></textarea></div>`;
    } else {
        htmlContenu += `<div class="question-block locked">üåô Question du soir √† 19h00...</div>`;
    }
    qList.innerHTML = htmlContenu;

    // 4. FONCTIONS
    function envoyer() {
        const prenom = document.getElementById('mon-prenom').value;
        const r1 = document.getElementById('rep1') ? document.getElementById('rep1').value : "";
        const r2 = document.getElementById('rep2') ? document.getElementById('rep2').value : "";

        if (!prenom || (!r1 && !r2)) return alert("Remplis ton nom et une r√©ponse ! ‚ù§Ô∏è");

        if(database) {
            database.ref('reponses').push({
                auteur: prenom,
                date: maintenant.toLocaleDateString('fr-FR'),
                h: maintenant.toLocaleTimeString('fr-FR', {hour: '2-digit', minute:'2-digit'}),
                m: r1, s: r2
            });
            alert("Envoy√© ! ‚ù§Ô∏è");
            if(document.getElementById('rep1')) document.getElementById('rep1').value = "";
            if(document.getElementById('rep2')) document.getElementById('rep2').value = "";
        }
    }

    if(database) {
        database.ref('reponses').limitToLast(10).on('value', (snap) => {
            const data = snap.val();
            let c = "";
            for (let id in data) {
                c = `<div class="res"><strong>${data[id].auteur}</strong> <small>${data[id].h}</small><br>${data[id].m ? '‚òÄÔ∏è '+data[id].m : ''}<br>${data[id].s ? 'üåô '+data[id].s : ''}</div>` + c;
            }
            document.getElementById('reponses-flux').innerHTML = c || "Aucun souvenir...";
        });
    }
</script>
</body>
</html>
