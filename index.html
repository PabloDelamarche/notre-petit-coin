<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notre Rituel ‚ù§Ô∏è</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
        body { font-family: 'Poppins', sans-serif; background: #fff0f3; text-align: center; padding: 20px; color: #444; margin: 0; }
        .card { background: white; max-width: 500px; margin: 20px auto; padding: 25px; border-radius: 30px; box-shadow: 0 10px 25px rgba(255,182,193,0.4); }
        
        /* Barre de progression */
        .progress-container { background: #eee; border-radius: 20px; margin: 20px 0; height: 25px; position: relative; overflow: hidden; border: 1px solid #ffd1d1; }
        .progress-bar { background: linear-gradient(90deg, #ff758c, #ff4d6d); height: 100%; width: 0%; transition: width 1s ease-in-out; }
        .progress-text { position: absolute; width: 100%; top: 50%; left: 0; transform: translateY(-50%); font-size: 0.8rem; font-weight: bold; color: #444; }

        .question-block { background: #fff5f6; margin: 15px 0; padding: 20px; border-radius: 20px; border-left: 6px solid #ff4d6d; text-align: left; }
        textarea { width: 100%; border: 1px solid #ddd; border-radius: 12px; padding: 12px; box-sizing: border-box; margin-top: 10px; font-family: inherit; resize: none; }
        input { width: 100%; max-width: 300px; padding: 12px; border-radius: 15px; border: 1px solid #ddd; margin: 15px 0; text-align: center; font-size: 1rem; }
        button { background: #ff4d6d; color: white; border: none; padding: 15px; border-radius: 50px; cursor: pointer; font-weight: bold; width: 100%; max-width: 300px; font-size: 1rem; }
        
        .res { font-size: 0.9rem; margin-top: 15px; text-align: left; background: #fff; padding: 15px; border-radius: 15px; border: 1px solid #ffe5ec; }
        .res b { color: #ff4d6d; }
        hr { border: 0; border-top: 1px dashed #ffd1d1; margin: 30px 0; }
    </style>
</head>
<body>

<div class="card">
    <h1>‚ú® Notre Rituel</h1>
    
    <div id="countdown-text" style="font-size: 0.9rem; margin-bottom: 5px; font-weight: 600;">Calcul...</div>
    <div class="progress-container">
        <div id="myBar" class="progress-bar"></div>
        <div id="percent-text" class="progress-text">0%</div>
    </div>

    <div id="questions-zone">Chargement des questions...</div>
    
    <input type="text" id="mon-prenom" placeholder="Ton petit nom...">
    <button onclick="envoyer()">Envoyer ‚ù§Ô∏è</button>
    
    <hr>
    <div id="reponses-flux">En attente de vos mots...</div>
</div>

<script>
    // --- 1. CONFIGURATION FIREBASE ---
    const CONFIG = {
        databaseURL: "TON_URL_FIREBASE_ICI"
    };

    // --- 2. DATES RETROUVAILLES ---
    const dateRetrouvailles = new Date("2026-03-15"); 
    const dateDepart = new Date("2026-02-01");        

    // --- 3. TOUTES TES QUESTIONS ---
    const qMatin = [
        "Quelle est la premi√®re chose que tu ferais si tu te r√©veillais dans ma peau demain matin ?",
        "Si on √©tait dans un film d'horreur, lequel de nous deux mourrait en premier √† cause d'une d√©cision d√©bile ?",
        "Si je devais me transformer en un objet de ta chambre, tu aimerais que je sois quoi ?",
        "Si je devais √™tre une saveur de glace, je serais quoi : un truc classique ou un parfum bizarre ?",
        "C'est quoi la rumeur la plus dr√¥le qu'on pourrait lancer sur notre couple ?",
        "Si on devait inventer une nouvelle f√™te, on f√™terait quoi ensemble ?",
        "C'est quoi la derni√®re b√™tise que tu as eu envie de faire avec moi ?",
        "Quel est le trait de caract√®re que j'ai et qui te fait dire : 'C'est vraiment mon/ma partenaire √ßa' ?",
        "Si on √©tait un couple de c√©l√©brit√©s, on serait qui ?"
    ];

    const qSoir = [
        "Si tu pouvais figer le temps sur un seul moment qu'on a v√©cu ensemble, ce serait lequel ?",
        "Si tu devais me donner un 'bon pour...' valable d√®s nos retrouvailles, ce serait pour quoi ?",
        "Quelle est la partie de ton corps que tu as le plus h√¢te que je touche ?",
        "Si on jouait √† 'Action ou V√©rit√©' ce soir, tu choisirais quoi et ce serait quoi ?",
        "Si tu avais un acc√®s illimit√© √† mon corps pendant 30 minutes, par o√π commencerais-tu ?",
        "Si je te liais les mains, quelle serait ta premi√®re r√©action : peur ou excitation ?",
        "Qu'est-ce qui t'excite le plus : me voir me d√©shabiller lentement ou que je t'arrache tes v√™tements ?",
        "Si tu devais choisir entre 'tr√®s lent et romantique' ou 'rapide et sauvage' pour nos prochaines retrouvailles, tu choisirais quoi ?"
    ];

    // --- 4. CALCULS ---
    const maintenant = new Date();
    const heure = maintenant.getHours();
    const indexJour = Math.floor(maintenant / (1000 * 60 * 60 * 24)); 

    const total = dateRetrouvailles - dateDepart;
    const ecoule = maintenant - dateDepart;
    let pourcent = Math.floor((ecoule / total) * 100);
    pourcent = Math.min(100, Math.max(0, pourcent));
    const reste = Math.ceil((dateRetrouvailles - maintenant) / (1000 * 60 * 60 * 24));

    document.getElementById('myBar').style.width = pourcent + "%";
    document.getElementById('percent-text').innerText = pourcent + "%";
    document.getElementById('countdown-text').innerText = "Plus que " + reste + " jours avant le bonheur ! üòç";

    const questMatin = qMatin[indexJour % qMatin.length];
    const questSoir = qSoir[indexJour % qSoir.length];

    let zoneHtml = `<div class="question-block">‚òÄÔ∏è <b>Matin :</b><br>${questMatin}<textarea id="r1" placeholder="Ta r√©ponse..."></textarea></div>`;

    if (heure >= 19 || heure < 6) {
        zoneHtml += `<div class="question-block" style="border-left-color: #7209b7;">üåô <b>Soir :</b><br>${questSoir}<textarea id="r2" placeholder="Ta r√©ponse..."></textarea></div>`;
    } else {
        zoneHtml += `<div class="question-block" style="opacity:0.5; border-left-color:#ccc;">üåô Question du soir √† 19h...</div>`;
    }
    document.getElementById('questions-zone').innerHTML = zoneHtml;

    // --- 5. FIREBASE ---
    try {
        firebase.initializeApp(CONFIG);
        const db = firebase.database();
        
        window.envoyer = function() {
            const nom = document.getElementById('mon-prenom').value;
            const res1 = document.getElementById('r1') ? document.getElementById('r1').value : "";
            const res2 = document.getElementById('r2') ? document.getElementById('r2').value : "";
            if(!nom || (!res1 && !res2)) return alert("Ton pr√©nom et au moins une r√©ponse ! ‚ù§Ô∏è");

            db.ref('reponses').push({
                auteur: nom,
                matin: res1,
                soir: res2,
                timestamp: maintenant.toLocaleString('fr-FR')
            });
            alert("Envoy√© ! ‚ù§Ô∏è");
            location.reload(); 
        };

        db.ref('reponses').limitToLast(5).on('value', (snap) => {
            const data = snap.val();
            let htmlFlux = "";
            for (let id in data) {
                let m = data[id];
                htmlFlux = `<div class="res"><b>${m.auteur}</b> <small style="color:#bbb; font-size:0.7rem;">(${m.timestamp})</small><br>${m.matin ? '‚òÄÔ∏è ' + m.matin + '<br>' : ''}${m.soir ? 'üåô ' + m.soir : ''}</div>` + htmlFlux;
            }
            document.getElementById('reponses-flux').innerHTML = htmlFlux;
        });
    } catch(e) { console.error(e); }
</script>
</body>
</html>
